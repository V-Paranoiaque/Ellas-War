<common-top-bar active="quests"></common-top-bar>

<div class="modal fade" id="SupportNewTopic" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" translate>Send a message to the staff</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" 
                id="SupportNewTopicClose"
                aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <input type="text" class="form-control"
               [(ngModel)]="contactNewTitle"
               placeholder="{{'Title'| translate}}" />
        <textarea class="form-control" placeholder="{{'Message'| translate}}"
                  [(ngModel)]="contactNewMsg"></textarea>
        <div class="text-center">
          <br/>
          <button class="btn btn-success" 
                  (click)="contactNewSend()"
                  translate>Send</button>
        </div>
      </div>
      <div class="modal-footer" translate>
        Our staff are volunteers however we will try to answer you as soon as possible.
      </div>
    </div>
  </div>
</div>

<div class="col-12 main">
  <div class="container">
    <div class="row">
      <div class="card">
        <div class="card-body text-center" *ngIf="id == 0">
          <div *ngIf="contactNb == 0" translate>You do not have message on the support page</div>
          <br/>
          <button class="btn btn-success" data-bs-toggle="modal"
                  data-bs-target="#SupportNewTopic" role="button" translate>
            Send a message to the staff
          </button>
          <br/>
          <br/>
          <table class="table" *ngIf="contactNb > 0">
            <tbody>
              <tr *ngFor="let info of contactList">
                <td class="text-start">
                  <a [routerLink]="['/support/'+info.support_id]">
                    {{info.support_topic}}
                  </a>
                </td>
                <td>
                  {{ info?.support_lastdate }}
                </td>
                <td>
                  {{info.last_username}}
                </td>
                <td>
                  <a class="btn btn-primary"
                     [routerLink]="['/support/'+info.support_id]">
                     <ic-icon [icon]="eye"></ic-icon>
                    <span class="visually-hidden" translate>Read and reply to the message:</span> 
                    <span class="visually-hidden">{{info.support_id}}</span>
                  </a>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="card-body"  *ngIf="id > 0">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
              <li class="breadcrumb-item"><a [routerLink]="['/support']">Support</a></li>
              <li class="breadcrumb-item active">{{contactInfo.title}}</li>
            </ol>
          </nav>
          
          <h2 class="text-center">{{contactInfo.title}}</h2>
          
          <div class="input-group">
            <textarea class="form-control custom-control" rows="5" 
                      style="resize:none" [(ngModel)]="answerMsg"
                      placeholder="{{'Enter your message'|translate}}"></textarea>
            <span class="input-group-addon btn btn-primary"
                  (click)="contactAnswer()" translate>Send</span>
          </div>
          
          <div *ngFor="let msg of contactInfo.msg">
            {{msg.support_msg}}
            <br/>
            <div class="text-end fw-bold">
              <span>{{'By { value }' | translate : { value: msg.username } }}</span>,
              {{msg.support_date*1000| date:'d/M, HH:mm'}}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<common-bottom-bar></common-bottom-bar>
