<common-top-bar active="options"></common-top-bar>

<div class="modal fade" id="AccountInformation" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" translate>Information</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" 
                aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="row text-center">
          <img src="{{ user.getConfig().url }}/pprofile/{{ imageProfile }}" *ngIf="imageProfile != ''"
               class="img-responsive center-block" alt="{{'Profile picture'| translate}}">
        </div>
        <div class="row text-center">
          <span translate>Send a picture</span>
          <input type="file" accept="image/*" (change)="uploadImage($event)"
                 [(ngModel)]="image" />
        </div>
        
        <div *ngIf="errorAccountSave == 1"
             class="text-center fw-bold text-danger" translate>
          Information saved
        </div>
        <strong for="localisation" translate>Location</strong>
        <input type="text" class="form-control" placeholder="{{'Location'|translate}}"
               [(ngModel)]="location" />
        <strong for="description" translate>Description</strong>
        <textarea class="form-control" placeholder="{{'Your description'|translate}}"
                  [(ngModel)]="description" ></textarea>
        <br/>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary"
                data-bs-dismiss="modal" translate>Close</button>
        <button type="button" class="btn btn-primary" (click)="accountSave()" 
                translate>Save</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="GameSettings" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" translate>Change game settings</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" 
                aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <select class="form-select" (change)="styleChange($event)" 
                  [(ngModel)]="currentStyle">
            <option value="default" translate>Default Style</option>
            <option value="red" translate>Red Style</option>
            <option value="pink" translate>Pink Style</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="fw-bold" for="language" translate>Language</label>
          <select class="form-select" (change)="languageChange($event)" 
                  [(ngModel)]="currentLanguage">
            <option value="fr" translate>French</option>
            <option value="en" translate>English</option>
          </select>
        </div>
        <div class="mb-3">
          <div class="form-check form-switch">
            <input id="gameSound" class="form-check-input" 
                   type="checkbox" [(ngModel)]="sound"
                   (change)="soundModify()" [checked]="sound" >
            <label class="form-check-label"
                   for="gameSound" translate>Sound</label>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary"
                data-bs-dismiss="modal" translate>Close</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="AccountPause" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" translate>Pause your account</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" 
                aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p translate>
          When you pause your account, you become unassailable for a fixed term but in return your resources and those of your alliance will not increase during this period.
        </p>
        <ul>
          <li [ngClass]="{'text-danger': user.getPropertyNb('id') == user.getPropertyNb('chief')}"
              translate>The leader of an alliance cannot pause.</li>
          <li translate>You need to wait 11 hours after your last attack to use the pause feature.</li>
        </ul>
      </div>
      <div class="modal-body text-center text-danger"
           *ngIf="pauseAllowed == 0" translate>
        Your are not allowed to put your account in pause.
      </div>
      <div class="modal-body text-center" *ngIf="pauseAllowed == 1">
        <strong translate>Between 4 and 100 days including</strong>
        <input type="number" min="4" max="100" class="form-control" [(ngModel)]="pauseNb" />
        <button class="btn btn-warning" (click)="accountPause()"
                translate>Put your account in pause</button>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary"
                data-bs-dismiss="modal" translate>Close</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="ChangeUsername" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" translate>Change your username</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" 
                aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="alert alert-danger" role="alert" *ngIf="getRenameError() > 0">
          <div [ngSwitch]="getRenameError()">
            <div *ngSwitchCase="1" translate>
              Your username must be at least 6 characters.
            </div>
            <div *ngSwitchCase="2" translate>
              This username is already used
            </div>
            <div *ngSwitchCase="3" translate>
              Username modified successfully
            </div>
            <div *ngSwitchCase="4" translate>
              You don't have enough favors
            </div>
          </div>
        </div>
        <div translate>At each change the cost is increased, 
                          it is reset every 6 months.</div>
        <div>
          <strong translate>Cost:</strong> {{ getAccountRenameCost() | number:'': this.translate.currentLang }} <id-to-ress [ress_id]="10"></id-to-ress>
        </div>
        
        <div *ngIf="user.getLevel() == 0"
             translate>From level 1 starting cost passes to one Favor</div>
        
        <div>
          <input type="text" class="form-control"  [(ngModel)]="newusername" 
                 placeholder="{{'New username'|translate}}" />
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                translate>Close</button>
        <button type="button" class="btn btn-primary" (click)="accountRename()" 
                translate>Confirm</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="ChangeEmail" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" translate>Change your email</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" 
                aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="alert alert-danger center"
             *ngIf="emailError == 1" translate>
          Your email is empty or invalid
        </div>
        
        <strong for="oldemail" translate>Old email</strong>
        <input type="text" class="form-control" disabled=""
               value="{{ user.getProperty('email') }}" 
               placeholder="{{'Old email'|translate}}" id="oldemail">
        <strong for="newemail" translate>New email</strong> 
        <input type="email" class="form-control" [(ngModel)]="newEmail"
               placeholder="{{'New email'|translate}}" id="newemail">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary"
                data-bs-dismiss="modal" translate>Close</button>
        <button class="btn btn-primary"
                (click)="accountEmail()"
                translate>Change your email</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="ChangePassword" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" translate>Change your password</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" 
                aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="alert alert-danger" role="alert" *ngIf="getPasswordError() > 0">
          <div [ngSwitch]="getPasswordError()">
            <div *ngSwitchCase="1" translate>
              Both passwords are different
            </div>
            <div *ngSwitchCase="2" translate>
              Your password must be at least 8 characters.
            </div>
            <div *ngSwitchCase="3" translate>
              Bad password
            </div>
            <div *ngSwitchCase="4" translate>
              Password changed successfully
            </div>
          </div>
        </div>
        
        <div *ngIf="accountPasswordPossible == 1">
          <strong for="oldpassword" translate>Old password</strong>
          <input type="password" class="form-control" [(ngModel)]="oldPassword"
                 placeholder="{{'Old password'|translate}}" id="oldpassword">
        </div>
        <strong for="newpassword" translate>New password</strong> 
        <input type="password" class="form-control" [(ngModel)]="newPassword"
               placeholder="{{'New password'|translate}}" id="newpassword">
        <strong for="confirm" translate>Confirmation</strong> 
        <input type="password" class="form-control" [(ngModel)]="confirm"
               placeholder="{{'Confirmation'|translate}}" id="confirm">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary"
                data-bs-dismiss="modal" translate>Close</button>
        <button class="btn btn-primary"
                (click)="accountPassword()"
                translate>Change your password</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="ResetAccount" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" translate>Reinitialize your account</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" 
                aria-label="Close"></button>
      </div>
      <div class="modal-body text-danger" translate>
        Warning, in case of confirmation your account will be reset 
        definitively. This action can not be undone.
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                translate>Close</button>
        <button type="button" class="btn btn-danger" (click)="reset()" 
                translate>Confirm</button>
      </div>
    </div>
  </div>
</div>

<div class="col-lg-10 col-md-10 col-sm-12 col-xs-12 main">
  <div class="container">
    <div class="row">
      <div class="col-xl-6 col-block-half">
        <div class="card">
          <div class="card-header" translate>
            Account
          </div>
          <div class="card-body" translate>
            Upload an avatar and add information about your self.
          </div>
          <div class="card-button card-button-primary" data-bs-toggle="modal" 
               role="button" data-bs-target="#AccountInformation" translate>
            Change account information
          </div>
        </div>
      </div>
      <div class="col-xl-6 col-block-half">
        <div class="card">
          <div class="card-header" translate>
            Parameters
          </div>
          <div class="card-body" translate>
            Switch the style of the game and enable/disable the notifications.
          </div>
          <div class="card-button card-button-primary" data-bs-toggle="modal" 
               role="button" data-bs-target="#GameSettings"
               (click)="parametersLoad()" translate>
            Change game settings
          </div>
        </div>
      </div>
      <div class="col-xl-6 col-block-half">
        <div class="card">
          <div class="card-header" translate>
            Pause
          </div>
          <div class="card-body" translate>
            Pause your account and come back later on Ellas War.
          </div>
          <div class="card-button card-button-primary" data-bs-toggle="modal" 
               role="button" data-bs-target="#AccountPause" translate>
            Pause your account
          </div>
        </div>
      </div>
      <div class="col-xl-6 col-block-half">
        <div class="card">
          <div class="card-header" translate>
            Username
          </div>
          <div class="card-body" *ngIf="getAccountRenameCost() == 0" translate>
            Choose a new Username for your account. While you stay level 0, 
            your first modification is free!
          </div>
          <div class="card-body" *ngIf="getAccountRenameCost() == 1" translate>
           Choose a new Username for your account. It will cost you 1 favor.
          </div>
          <div class="card-body" *ngIf="getAccountRenameCost() > 1">
           {{'Choose a new Username for your account. It will cost you { value } 
              favor(s).' | translate: { value: getAccountRenameCost() } }}
          </div>
          <div class="card-button card-button-primary" data-bs-toggle="modal" 
               role="button" data-bs-target="#ChangeUsername" translate>
            Change your username
          </div>
        </div>
      </div>
      <div class="col-xl-6 col-block-half">
        <div class="card">
          <div class="card-header" translate>
            Email
          </div>
          <div class="card-body" translate>
            Modify your email connected to your account.
          </div>
          <div class="card-button card-button-primary" data-bs-toggle="modal" 
               role="button" data-bs-target="#ChangeEmail" translate>
            Change your email
          </div>
        </div>
      </div>
      <div class="col-xl-6 col-block-half">
        <div class="card">
          <div class="card-header" translate>
            Password
          </div>
          <div class="card-body" translate>
            Modify your password.
          </div>
          <div class="card-button card-button-primary" data-bs-toggle="modal" 
               role="button" data-bs-target="#ChangePassword" translate>
            Change your password
          </div>
        </div>
      </div>
      <div class="col-xl-6 col-block-half">
        <div class="card">
          <div class="card-header" translate>
            Reset
          </div>
          <div class="card-body" translate>
            Reset your account and start a new adventure.
          </div>
          <div class="card-button card-button-primary" data-bs-toggle="modal" 
               role="button" data-bs-target="#ResetAccount" translate>
            Reinitialize your account
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<connected-right-menu></connected-right-menu>
<common-bottom-bar></common-bottom-bar>
